
////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2019, Perry L Miller IV
//  All rights reserved.
//  MIT License: https://opensource.org/licenses/mit-license.html
//
////////////////////////////////////////////////////////////////////////////////

////////////////////////////////////////////////////////////////////////////////
//
//  Test the scoped function call.
//
////////////////////////////////////////////////////////////////////////////////

#include "Usul/Tools/ScopedCall.h"

#include "catch2/catch.hpp"

#include <string>


////////////////////////////////////////////////////////////////////////////////
//
//  Test the scoped function call.
//
////////////////////////////////////////////////////////////////////////////////

TEST_CASE ( "Scoped function call" )
{
  std::string state = "At the top";

  {
    state = "Just entered the scope";

    USUL_SCOPED_CALL ( [&] ()
    {
      state = "Bye bye";
    } );

    state = "About to leave the scope";
  }

  REQUIRE ( "Bye bye" == state );
}
