
////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2019, Perry L Miller IV
//  All rights reserved.
//  MIT License: https://opensource.org/licenses/mit-license.html
//
////////////////////////////////////////////////////////////////////////////////

////////////////////////////////////////////////////////////////////////////////
//
//  Helper singleton class for keeping track of all referenced instances.
//
////////////////////////////////////////////////////////////////////////////////

#include "Helpers/Instances.h"

#include "catch2/catch.hpp"

namespace Helpers {


////////////////////////////////////////////////////////////////////////////////
//
//  Singleton instance.
//
////////////////////////////////////////////////////////////////////////////////

namespace Details
{
  Instances *_singleton = nullptr;
}


////////////////////////////////////////////////////////////////////////////////
//
//  Constructor.
//
////////////////////////////////////////////////////////////////////////////////

Instances::Instances() : _set()
{
}


////////////////////////////////////////////////////////////////////////////////
//
//  Destructor.
//
////////////////////////////////////////////////////////////////////////////////

Instances::~Instances()
{
}


////////////////////////////////////////////////////////////////////////////////
//
//  Singleton access.
//
////////////////////////////////////////////////////////////////////////////////

Instances &Instances::get()
{
  if ( !Details::_singleton )
  {
    Details::_singleton = new Instances();
  }
  return *Details::_singleton;
}


////////////////////////////////////////////////////////////////////////////////
//
//  Destroy the singleton.
//
////////////////////////////////////////////////////////////////////////////////

void Instances::destroy()
{
  Instances *temp = Details::_singleton;
  Details::_singleton = nullptr;
  delete temp;
}


} // namespace Helpers
