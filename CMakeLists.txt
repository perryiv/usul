
################################################################################
#
#  Copyright (c) 2019, Perry L Miller IV
#  All rights reserved.
#
################################################################################

################################################################################
#
#  Following this tutorial ...
#  https://vicrucann.github.io/tutorials/cmake-qt-osg-1/
#
################################################################################

# https://doc.qt.io/qt-5/cmake-manual.html
cmake_minimum_required ( VERSION 3.1.0 )

# The name of this project.
project ( usul_test )

# Use modern C++
# https://stackoverflow.com/questions/10851247/how-to-activate-c-11-in-cmake
set ( CMAKE_CXX_STANDARD 11 )

# Download the glue between cmake and conan if we don't already have it.'
if ( NOT EXISTS ${CMAKE_BINARY_DIR}/conan.cmake )
  message ( STATUS "Downloading conan.cmake from https://github.com/memsharded/cmake-conan" )
  file ( DOWNLOAD "https://github.com/conan-io/cmake-conan/raw/master/conan.cmake" "${CMAKE_BINARY_DIR}/conan.cmake" )
endif()

# Include the file from above step into this file.
include ( ${CMAKE_BINARY_DIR}/conan.cmake )

# Run the function from above file which runs conan and passes it a lot of
# information that cmake has, which is why we do it this way.
conan_cmake_run ( CONANFILE conanfile.txt BUILD missing )

# Include the file generated by conan_cmake_run above.
include ( ${CMAKE_BINARY_DIR}/conanbuildinfo.cmake )

# More efficient command-line for compiler and linker.
# With TARGETS here I need "CONAN_PKG::Catch2" below.
conan_basic_setup ( TARGETS )

# Define a variable that holds all the source files.
set ( SOURCE_FILES
  tests/Usul/Math/Base.cpp
  tests/Usul/Math/CloseFloat.cpp
  tests/Usul/Math/Functions.cpp
  tests/Usul/Math/Vector2.cpp
  tests/Usul/Math/Vector3.cpp
  tests/Usul/Math/Vector4.cpp
  tests/Usul/Main.cpp
)

# Make an executable.
add_executable ( ${PROJECT_NAME} ${SOURCE_FILES} )

# We're going to use this library.
# CMake will automatically add -I, -L, and -D (etc) appropriately.
target_link_libraries ( ${PROJECT_NAME} PRIVATE usul_math CONAN_PKG::Catch2 )

# Define a variable that points to the top-level include directory.
set ( USUL_INC_DIR ${CMAKE_CURRENT_SOURCE_DIR}/include )

# Also process the CMakeLists.txt found in this directory.
add_subdirectory ( src/Usul/Math )
